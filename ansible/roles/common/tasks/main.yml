---
- name: Yum update packages
  yum: name=* state=latest
#  when: yum_update == "Y"

# EPEL/Remi/RPMforgeをインストールする
- name: add repository
  yum: name={{item}}
  with_items:
    #ansibleを先にインストールしたいのでansible実行シェルでaddしている
    #sudo rpm -iUvh http://dl.fedoraproject.org/pub/epel/7/x86_64/e/epel-release-7-5.noarch.rpm
    - http://rpms.famillecollet.com/enterprise/remi-release-7.rpm
    - http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm

# 明示的に指定したいのでenabledは全て0にする
- name: set repository epel,remi
  replace: dest=/etc/yum.repos.d/{{item}} regexp="enabled *= *1" replace="enabled=0"
  with_items:
    - epel.repo
    - remi.repo
